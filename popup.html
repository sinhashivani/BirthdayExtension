<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loyalty Program Assistant</title>
    <link rel="stylesheet" href="popup.css">
</head>

<body>
    <div class="container">
        <header>
            <div class="logo">
                <img src="icons/icon48.png" alt="Loyalty Program Assistant Logo">
                <h1>Loyalty Program Assistant</h1>
            </div>
            <div class="actions">
                <button id="settingsBtn" class="btn-icon" title="Settings">
                    <span class="icon">‚öôÔ∏è</span>
                </button>
            </div>
        </header>

        <main>
            <!-- Profile Selection Section -->
            <section class="section profile-section">
                <h2>Select Profile</h2>
                <div class="profile-selector">
                    <select id="profileSelect">
                        <option value="" disabled selected>Select a profile</option>
                        <!-- Profiles will be loaded dynamically -->
                    </select>
                    <button id="manageProfilesBtn" class="btn-secondary">Manage Profiles</button>
                </div>
            </section>

            <!-- Controls Section -->
            <section class="section controls-section">
                <div class="control-group">
                    <h3>Autofill Controls</h3>
                    <div class="toggle-container">
                        <label class="toggle">
                            <input type="checkbox" id="autofillToggle" checked>
                            <span class="slider"></span>
                        </label>
                        <span class="toggle-label">Enable Autofill</span>
                    </div>
                </div>

                <div class="button-group">
                    <button id="scanPageBtn" class="btn-primary">Scan Page</button>
                    <button id="fillFormsBtn" class="btn-primary">Fill Forms</button>
                    <button id="resetFormsBtn" class="btn-secondary">Reset Forms</button>
                </div>
            </section>

            <!-- Tracker Overview Section -->
            <section class="section tracker-section">
                <div class="section-header">
                    <h2>Submission Tracker</h2>
                    <div class="tracker-actions">
                        <button id="exportTrackerBtn" class="btn-icon" title="Export Tracker Data">
                            <span class="icon">üì§</span>
                        </button>
                        <select id="exportFormatSelect">
                            <option value="csv">CSV</option>
                            <option value="json">JSON</option>
                        </select>
                    </div>
                </div>

                <div class="tracker-overview">
                    <div class="stat-box">
                        <h4>Total Submissions</h4>
                        <span id="totalSubmissions" class="stat-number">0</span>
                    </div>
                    <div class="stat-box">
                        <h4>With Birthday Fields</h4>
                        <span id="birthdayFields" class="stat-number">0</span>
                    </div>
                    <div class="stat-box">
                        <h4>Success Rate</h4>
                        <span id="successRate" class="stat-number">0%</span>
                    </div>
                </div>

                <div class="view-all-container">
                    <button id="viewTrackerBtn" class="btn-text">View Full Tracker <span class="arrow">‚Üí</span></button>
                </div>
            </section>

            <!-- Status Section -->
            <section class="section status-section">
                <div id="statusContainer" class="status-container">
                    <div class="status-message">
                        <span class="status-icon">‚úÖ</span>
                        <span class="status-text">Ready to assist with loyalty program enrollments</span>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <button id="helpBtn" class="btn-text">How to Use</button>
            <span class="version">v1.0</span>
        </footer>
    </div>

    <!-- Template for the field preview overlay -->
    <template id="fieldPreviewTemplate">
        <div class="field-preview-overlay">
            <div class="field-preview-header">
                <h3>Fields Detected</h3>
                <button class="close-preview">√ó</button>
            </div>
            <div class="field-preview-content">
                <div class="field-list">
                    <!-- Field items will be inserted here -->
                </div>
                <div class="field-preview-actions">
                    <button class="btn-secondary cancel-fill">Cancel</button>
                    <button class="btn-primary confirm-fill">Confirm & Fill</button>
                </div>
            </div>
        </div>
    </template>

    <!-- Template for the help modal -->
    <template id="helpModalTemplate">
        <div class="modal-overlay">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>How to Use Loyalty Program Assistant</h3>
                    <button class="close-modal">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="help-section">
                        <h4>Quick Start Guide</h4>
                        <ol>
                            <li>Create a profile with your information in the Settings page</li>
                            <li>Browse to a loyalty program signup form</li>
                            <li>Click "Scan Page" to detect form fields</li>
                            <li>Review the detected fields and click "Confirm & Fill"</li>
                            <li>Submit the form manually after reviewing</li>
                            <li>The extension will track your submission</li>
                        </ol>
                    </div>
                    <div class="help-section">
                        <h4>Tips</h4>
                        <ul>
                            <li>Green entries in the tracker indicate forms with birthday fields - these are likely to
                                provide birthday rewards!</li>
                            <li>You can create multiple profiles for different purposes</li>
                            <li>The extension works best on standard web forms</li>
                            <li>Check the submission tracker regularly to keep track of your enrollments</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <script src="utils.js"></script>
    <script src="popup.js"></script>
</body>

</html>